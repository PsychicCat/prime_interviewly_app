var app = angular.module('app', ['ngMaterial', 'ngRoute', 'ngMessages', 'ui.grid', 'ui.grid.edit', 'ui.grid.rowEdit', 'ui.grid.exporter']);

/*
 Angular configuration
 */
app.config(['$routeProvider', '$locationProvider', '$mdThemingProvider', function($routeProvider, $locationProvider, $mdThemingProvider){

    // Color palette
    $mdThemingProvider.theme('default')
        .primaryPalette('blue-grey')
        .accentPalette('orange');

    // HTML5 mode
    $locationProvider.html5Mode({
        enabled: true
    });

    // Routes
    $routeProvider.
        when('/home', {
            templateUrl: 'views/partials/home/home.html'
        }).
        when('/', {
            templateUrl: 'views/partials/account/login/login.html'
        }).
        when('/forgot', {
            templateUrl: 'views/partials/account/forgot/forgot.html'
        }).
        when('/events', {
            templateUrl: 'views/partials/events/events-list/events-list.html'
        }).
        when('/event?:eventId', {
            templateUrl: 'views/partials/events/view-event/view-event.html'
        }).
        when('/event/add-students?:eventId', {
            templateUrl: 'views/partials/events/add-students/add-students.html'
        }).
        when('/event/add-interviewers?:eventId', {
            templateUrl: 'views/partials/events/add-interviewers/add-interviewers.html'
        }).
        when('/event/schedule?:eventId', {
            templateUrl: 'views/partials/events/schedule/schedule.html'
        }).
        when('/students', {
            templateUrl: 'views/partials/students/students.html'
        }).
        when('/interviewers', {
            templateUrl: 'views/partials/interviewers/interviewers.html'
        }).
        when('/archived-events', {
            templateUrl: 'views/partials/events/archived-events/archived-events.html'
        }).
        when('/profile', {
            templateUrl: 'views/partials/account/profile/profile.html'
        }).
        when('/logout', {
            templateUrl: 'views/partials/account/logout/logout.html'
        }).
        when('/new-event', {
            templateUrl: 'views/partials/events/new-event/new-event.html'
        }).
        when('/reset/:token', {
            templateUrl: 'views/partials/account/reset/reset.html',
            controller: 'reset'
        }).
        otherwise({
            redirectTo: '/'
    })
}]);

/*
Toolbar controller
 */
app.controller('toolbar', ['$rootScope','$location','$scope', '$window', function($rootScope, $location, $scope, $window){
    $scope.paths = true;
    $rootScope.$on('logged In', function(){
        if($window.sessionStorage.token == undefined){
            $scope.paths = true;
        }else{
            $scope.paths = false;
            $scope.user = {
                username: $window.sessionStorage.username.replace(/^"(.*)"$/, '$1')
            };
        }
    });
    $scope.goHome = function(){
        $location.path('/');
    }
}]);

/*
Directive to check the passwords are the same
 */
app.directive("passwordVerify", function() {
    return {
        require: "ngModel",
        scope: {
            passwordVerify: '='
        },
        link: function(scope, element, attrs, ctrl) {
            scope.$watch(function() {
                var combined;
                if (scope.passwordVerify || ctrl.$viewValue) {
                    combined = scope.passwordVerify + '_' + ctrl.$viewValue;
                }
                return combined;
            }, function(value) {
                if (value) {
                    ctrl.$parsers.unshift(function(viewValue) {
                        var origin = scope.passwordVerify;
                        if (origin !== viewValue) {
                            ctrl.$setValidity("passwordVerify", false);
                            return undefined;
                        } else {
                            ctrl.$setValidity("passwordVerify", true);
                            return viewValue;
                        }
                    });
                }
            });
        }
    };
});

/*
Student dialog controller
 */
app.controller('uploads', ['$scope', '$mdDialog', function($scope, $mdDialog){
    $scope.openUploads = function(ev){
        $mdDialog.show({
            controller: uploadFile,
            templateUrl: 'views/partials/dialogs/upload/upload.html',
            parent: angular.element(document.body),
            targetEvent: ev,
            clickOutsideToClose: true
        })
    };
    function uploadFile($scope, $mdDialog){

        $scope.submit = function(file){
            var mine = {
                file: file
            };
        console.log(mine);
        };
        $scope.close = function() {
            $mdDialog.hide();
        }
    }
}]);

/*
Home controller
 */

/*
Register dialog controller
 */
app.controller('registerOpen', ['$scope', '$mdDialog', '$http', function($scope, $mdDialog){
    $scope.openRegister = function(ev){
        $mdDialog.show({
            controller: register,
            templateUrl: 'views/partials/dialogs/register/register.html',
            parent: angular.element(document.body),
            targetEvent: ev,
            clickOutsideToClose: true
        })
    };
    function register($scope, $http, $mdDialog) {
        $scope.register = function(username, email, password){
            $http.post('/api/users', {
                username: username,
                email: email,
                password: password
            }).then(function(response){
                console.log(response);
                if(response == 200) {
                    $mdDialog.hide()
                }
            });
        };
        $scope.close = function(){
            $mdDialog.hide();
        };
    }
}]);
app.controller('interviewers', ['$scope', '$http', function($scope, $http){
  $http.get('/api/interviewer').then(function(response){
   console.log(response);
   $scope.interviewers = response.data
  })
}]);
app.controller('students', ['$scope', '$http', '$mdDialog', function($scope, $http, $mdDialog){
    $http.get('/api/student').then(function (response) {
        console.log(response);
        $scope.students = response.data
    });

    $scope.editStudent = function(id) {
        $http.get('/api/student?_id=' + id).then(function (response) {
            $scope.student = response.data[0];
            console.log('hello');
            $mdDialog.show({
                controller: 'editStudent',
                locals: {
                    items: $scope.student
                },
                templateUrl: 'views/partials/dialogs/student/studentEdit.html',
                parent: angular.element(document.body),
                clickOutsideToClose: true
            })
        })
    };
}]);
app.controller('editStudent', ['$scope', '$mdDialog', 'items', function($scope, $mdDialog, items){
    $scope.student = items;

    $scope.close = function(){
        $mdDialog.hide();
    }
}]);

/*
Student dialog controller
 */
app.controller('student', ['$scope', '$mdDialog', function($scope,$mdDialog){
    $scope.openStudents = function(ev){
        $mdDialog.show({
            controller: addStudent,
            templateUrl: 'views/partials/dialogs/student/student.html',
            parent: angular.element(document.body),
            targetEvent: ev,
            clickOutsideToClose: true
        })
    };
    function addStudent($scope) {
        $scope.close = function () {
            $mdDialog.hide();
            $scope.companies = [
                {name: 'Prime'},
                {name: 'Nerdery'},
                {name: 'Digital People'}
            ];
            $scope.events = [
                {name: 'mocks Delta'},
                {name: 'career Delta'},
                {name: 'mocks Epsilon'}
            ];
        };
        $scope.submit = function(fname, lname, email, cohort){
            var student = {
                fname: fname,
                lname: lname,
                email: email,
                cohort: cohort
            };
            console.log(student);
        }
    }

}]);
app.controller('addStudents', ['$scope', '$http', '$routeParams', function($scope, $http, $routeParams){

    $http.get('/api/student').then(function (response) {
        console.log(response);
        $scope.students = response.data
    });

    var eventParam = $routeParams._id;
    $scope.eventId = eventParam;
    console.log(eventParam);

    $scope.addStudent = function(id) {
        $http({
            method: 'POST',
            url: '/api/event/addStudent?_id=' + eventParam,
            data: event
        }).then(function success(data) {
            console.log(data);
        }, function error() {
        }).then(function redirect() {
            // hide row
        });
    }
}]);


/*
Interviewer dialog controller
 */
app.controller('interviewer', ['$scope', '$mdDialog', function($scope, $mdDialog){
    $scope.openInterviewer = function(ev){
        $mdDialog.show({
            controller: addInterviewer,
            templateUrl: 'views/partials/dialogs/interviewer/interviewer.html',
            parent: angular.element(document.body),
            targetEvent: ev,
            clickOutsideToClose: true
        })
    };
    function addInterviewer($scope){
        $scope.close = function() {
            $mdDialog.hide();
            $scope.cohorts = [
                {name: 'Delta'},
                {name: 'gamma'},
                {name: 'Epsilon'}
            ];
            $scope.events = [
                {name: 'mocks Delta'},
                {name: 'career Delta'},
                {name: 'mocks Epsilon'}
            ];
        };
        $scope.submit = function(fname, lname, title, company, link, desc){
            var interviewer = {
                fName: fname,
                lName: lname,
                title: title,
                company: company,
                link: link,
                description: desc
            };
            console.log(interviewer);
        };
    }
}]);

/*
Archived events controller
 */

/*
 Events list controller
  */
app.controller('eventsCtrl', ['$scope', '$http', '$filter', function($scope, $http, $filter) {
    $http.get('/api/event').then(function success(response) {

        // set get request to a variable
        eventsList = response.data;

        // initialize an empty array for storing data to be used in ng-repeat
        var tiles = [];

        // iterate over response data and push objects into array for ng-repeat
        eventsList.forEach(function(item, pos) {
            tiles.push({title: title = item.cohort + ' ' + item.type, date: $filter('date')(new Date(item.date), 'MM/dd/yy'), _id: item._id});
        });

        // set scope tiles equal to the object array
        $scope.tiles = tiles;

    }, function error() {});

}]);


app.controller('modalCtrl', ['$scope', '$mdDialog', function($scope, $mdDialog) {
    $scope.alert = '';

    $scope.showAlert = function (ev) {
        // Appending dialog to document.body to cover sidenav in docs app
        var confirm = $mdDialog.confirm()
            .title('You are about to Archive this Event!')
            .content('Click to confirm. You can access this Event at any time in Archived Events.')
            .ariaLabel('Archive')
            .targetEvent(ev)
            .ok('Got it!')
            .cancel('Nevermind.');

        $mdDialog.show(confirm).then(function () {
            $scope.status = 'You archived this event.';
        }, function () {
            $scope.status = 'You did not archive this event.';
        });
    };

    $scope.showConfirm = function (ev) {
        // Appending dialog to document.body to cover sidenav in docs app
        var confirm = $mdDialog.confirm()
            .title('Would you like to delete this Event?')
            .content('This will permanently delete this Event.')
            .ariaLabel('Delete')
            .targetEvent(ev)
            .ok('Yes, delete this Event!')
            .cancel('No way, that was close!');

        $mdDialog.show(confirm).then(function () {
            $scope.status = 'You deleted this event.';
        }, function () {
            $scope.status = 'You did not delete this event.';
        });
    };
}]);

/*
 New event controller
  */
app.controller('newEventCtrl', ['$scope', '$http', '$location', '$filter', function($scope, $http, $location, $filter) {
    $scope.submit = function() {

        var event = {
            type: $scope.eventType,
            cohort: $scope.cohort,
            date: $scope.date,
            location: $scope.location,
            startTime: $filter('date')(new Date($scope.sTime), 'HH:mm'),
            endTime: $filter('date')(new Date($scope.eTime), 'HH:mm'),
            interviewDuration: $scope.slotDur,
            organizer: $scope.organizer
        };

        $http({
            method: 'POST',
            url: 'api/event',
            data: event
        }).then(function success(data) {
            console.log(data);
        }, function error() {}).then(function redirect() {
            $location.path('/events')
        })
    }
}]);

/*
 View events controller
 */
app.controller('viewEventCtrl', ['$scope', '$http', '$filter', '$routeParams', function($scope, $http, $filter, $routeParams) {

    var eventParam = $routeParams._id;
    $scope.eventId = eventParam;

    $http.get('/api/event?_id=' + eventParam).then(function success(response) {

        $scope.eventTitle = response.data[0].cohort + ' ' + response.data[0].type;
        $scope.eventDate = $filter('date')(new Date(response.data[0].date), 'MM/dd/yy');
        $scope.eventStime = response.data[0].startTime;
        $scope.eventEtime = response.data[0].endTime;
        $scope.eventDur = response.data[0].interviewDuration;
        $scope.eventLoc = typeof response.data[0].location != 'undefined' ? response.data[0].location : 'NA';
        $scope.eventOrg = typeof response.data[0].organizer != 'undefined' ? response.data[0].organizer : 'NA';

    }, function error() {});

}]);

/*
Generate event controller
 */
app.controller('generateCtrl', ['$scope', '$http', function($scope, $http) {

    // time experiments
    var startTime = moment('1:00 PM', 'h:mm A').format('HH:mm');
    var endTime = moment('4:00 PM', 'h:mm A').format('HH:mm');
    var eventLength = moment(endTime, 'HH:mm').diff(moment(startTime, 'HH:mm'), 'minutes');
    var slotLength = moment.duration((eventLength / 9), 'minutes').asMinutes();
    console.log(moment(startTime, 'HH:mm').add((slotLength * 8), 'minutes').format('h:mm A'));

    // Initialize UI Grid variables
    var gridCols = [];
    var gridData = [];

    // UI Grid options
    $scope.gridOptions = {
        enableSorting: false,
        enableGridMenu: true,
        enableFiltering: false,
        onRegisterApi: function (gridApi) {
            $scope.gridApi = gridApi;
        }
    };

    // "Generate" button click function
    $scope.generate = function () {

        // request matches from server given event settings
        $http({
            method: 'GET',
            url: 'http://localhost:3000/test'
        }).then(function successCallback(response) {

            // empty the UI Grid variables in case there is data
            $scope.gridOptions.columnDefs = [];
            $scope.gridOptions.data = [];
            gridCols = [];
            gridData = [];

            // console log API response for debugging
            console.log(response);

            // iterate over the interviewer array within the response
            // create various arrays and objects to meet UI Grid data requirements
            response.data.interviewer.forEach(function(item, pos) {

                // push the company and interviewer name into the column names array
                // this will be the column header for a particular interviewer
                gridCols.push({name: item.company + ' / ' + item.fName, field: item.company + '_' + item.name, width:150, displayName: item.company + ' / ' + item.fName});

                // set the scheduled object to a variable
                // this object contains the entire schedule for an interviewer
                var sched = item.scheduled;

                // initiate an empty students array
                // this will be used to store the formatted schedule for each company
                var students = [];

                // iterate over the scheduled object using the getOwnPropertyNames method
                Object.getOwnPropertyNames(sched).forEach(function (elem, index, array) {

                    // create an array of objects that contains each scheduled item
                    // this array will contain the formatted schedule for an interviewer
                    titleObj = {};
                    titleObj[item.company + '_' + item.fname] = sched[elem];
                    students.push(titleObj);
            });

            // push the updated schedule array into the master gridData array
            gridData.push(students);
            });

            // gridData is still not correctly formatted
            // each item represents an interviewer column
            // when in fact, UI Grid requires each item in the array to be a row of data
            // Underscore unzip function performs necessary matrix transformation
            gridData = _.unzip(gridData);

            // initiate empty array to store each row as an object of objects
            var gridArr = [];

            // iterate over unzipped gridData
            gridData.forEach(function (item, pos) {

                // initiate empty object for storing individual schedule items
                var rowObj = {};

                // iterate over the schedule row
                // each item in the row array represents a single cell in the grid
                item.forEach(function (elem, index) {
                    // use Underscore extend method to "push" each item into row object
                    _.extend(rowObj, elem);
                });

                // push the row object into the previously initiated grid array
                gridArr.push(rowObj);
            });

            // initiate an empty object for storing the entire schedule
            gridObj = {};

            // create time slots column
            var timeSlots = [];
            var slotsSize = gridArr.length;
            while(slotsSize--) {
                timeSlots.push({time: 'Slot ' + ((gridArr.length) - slotsSize)});
            }

            console.log(timeSlots);

            // using Underscore extend again, "push" the array of objects into the master object
            _.extend(gridObj, gridArr);

            // update the gridData variable
            gridData = gridArr;
        }).then(function() {

            // after capturing and formatting the data, update UI Grid options
            $scope.gridOptions.columnDefs = gridCols;
            $scope.gridOptions.data = gridData;
        })
    };
}]);

/*
 Forgot controller
  */
app.controller('sendEmail', ['$scope', '$http', '$location', function($scope, $http, $location){
    $scope.send = function(email) {
        $http.post('/forgot', {email: email}).then(function (response) {
            if (response.status == 200) {
                $location.path('/')
            }
        })
    }
}]);

/*
 Logout controller
  */
app.controller('logout', ['$rootScope', '$scope','$location', '$interval', function($rootScope, $scope, $location, $interval){
    $scope.logout = function(){
        $location.path('/logout');
        sessionStorage.clear();
        $rootScope.$broadcast('logged In');
        $interval(function() {
            $location.path('/')
        }, 3000, 1)
    };
}]);

/*
 Profile controller
  */
app.controller('profile', ['$scope', '$http', '$window', '$location', function($scope, $http, $window, $location){
    $scope.username = $window.sessionStorage.username.replace(/^"(.*)"$/, '$1');
    $scope.email = $window.sessionStorage.email.replace(/^"(.*)"$/, '$1');
    $scope.save = function(password){
        var username = $scope.username;
        var email = $scope.email;
        $http.post('/change', {username: username, email: email, password: password}).then(function(response){
            if(response.status === 200){
                $location.path('/events')
            }
        });
    };
    $scope.switch = function(){
        var off = disabled;
        var on = enabled;

        if($scope.enabled = off){
            $scope.enabled = on
        } else {
            $scope.enabled = off;
        }
        console.log($scope.enabled)
    }
}]);

/*
 Reset controller
  */
app.controller('reset',['$scope', '$http', '$routeParams', '$location', function($scope, $http, $routeParams, $location){
    $scope.changePass = function(password, confirm){
        console.log(password);
        var token = $routeParams.token;
        if(password === confirm){
            $http.post('/reset', {password: password, token: token}).then(function(response){
                console.log(response);
                if(response.status === 200){
                    $location.path('/');
                }
            })
        }
    }
}]);

/*
 Login controller
  */
app.controller('login', ['$rootScope','$scope', '$http', '$location', '$mdToast', function($rootScope, $scope, $http, $location, $mdToast){
    $scope.submit = function(username, password){
        $http.post('/authenticate', {username: username, password: password}).then(function(response){
                if(response.data.token){
                    sessionStorage.username = angular.toJson(response.data.user.username);
                    sessionStorage.email = angular.toJson(response.data.user.email);
                    sessionStorage.token = angular.toJson(response.data.token);
                    $location.path('/events');
                    $rootScope.$broadcast('logged In')
                }else{
                    $mdToast.showSimple(response.data.error)
                }

            }

        )
    };
    $scope.forgot = function(){
        $location.path('/forgot');
    }
}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImRpYWxvZ3MvdXBsb2FkL3VwbG9hZC5jb250cm9sbGVyLmpzIiwiaG9tZS9ob21lLmNvbnRyb2xsZXIuanMiLCJkaWFsb2dzL3JlZ2lzdGVyL3JlZ2lzdGVyLmNvbnRyb2xsZXIuanMiLCJpbnRlcnZpZXdlcnMvaW50ZXJ2aWV3ZXJzLmNvbnRyb2xsZXIuanMiLCJzdHVkZW50cy9zdHVkZW50cy5jb250cm9sbGVyLmpzIiwiZGlhbG9ncy9zdHVkZW50L3N0dWRlbnQuY29udHJvbGxlci5qcyIsImV2ZW50cy9hZGQtc3R1ZGVudHMvYWRkLXN0dWRlbnRzLmNvbnRyb2xsZXIuanMiLCJldmVudHMvYWRkLWludGVydmlld2Vycy9hZGQtaW50ZXJ2aWV3ZXJzLmNvbnRyb2xsZXIuanMiLCJkaWFsb2dzL2ludGVydmlld2VyL2ludGVydmlld2VyLmNvbnRyb2xsZXIuanMiLCJldmVudHMvYXJjaGl2ZWQtZXZlbnRzL2FyY2hpdmVkLWV2ZW50cy5jb250cm9sbGVyLmpzIiwiZXZlbnRzL2V2ZW50cy1saXN0L2V2ZW50cy1saXN0LmNvbnRyb2xsZXIuanMiLCJldmVudHMvbmV3LWV2ZW50L25ldy1ldmVudC5jb250cm9sbGVyLmpzIiwiZXZlbnRzL3ZpZXctZXZlbnQvdmlldy1ldmVudC5qcyIsImV2ZW50cy9zY2hlZHVsZS9zY2hlZHVsZS5jb250cm9sbGVyLmpzIiwiYWNjb3VudC9mb3Jnb3QvZm9yZ290LmNvbnRyb2xsZXIuanMiLCJhY2NvdW50L2xvZ291dC9sb2dvdXQuY29udHJvbGxlci5qcyIsImFjY291bnQvcHJvZmlsZS9wcm9maWxlLmNvbnRyb2xsZXIuanMiLCJhY2NvdW50L3Jlc2V0L3Jlc2V0LmNvbnRyb2xsZXIuanMiLCJhY2NvdW50L2xvZ2luL2xvZ2luLmNvbnRyb2xsZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDMUhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzFCQTtBQUNBO0FBQ0E7QUFDQTtBQ0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3ZDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN2QkE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDeENBO0FBQ0E7QUFDQTtBQUNBO0FDSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDOURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNyQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDN0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDWkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDM0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbJ25nTWF0ZXJpYWwnLCAnbmdSb3V0ZScsICduZ01lc3NhZ2VzJywgJ3VpLmdyaWQnLCAndWkuZ3JpZC5lZGl0JywgJ3VpLmdyaWQucm93RWRpdCcsICd1aS5ncmlkLmV4cG9ydGVyJ10pO1xuXG4vKlxuIEFuZ3VsYXIgY29uZmlndXJhdGlvblxuICovXG5hcHAuY29uZmlnKFsnJHJvdXRlUHJvdmlkZXInLCAnJGxvY2F0aW9uUHJvdmlkZXInLCAnJG1kVGhlbWluZ1Byb3ZpZGVyJywgZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyLCAkbWRUaGVtaW5nUHJvdmlkZXIpe1xuXG4gICAgLy8gQ29sb3IgcGFsZXR0ZVxuICAgICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnZGVmYXVsdCcpXG4gICAgICAgIC5wcmltYXJ5UGFsZXR0ZSgnYmx1ZS1ncmV5JylcbiAgICAgICAgLmFjY2VudFBhbGV0dGUoJ29yYW5nZScpO1xuXG4gICAgLy8gSFRNTDUgbW9kZVxuICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh7XG4gICAgICAgIGVuYWJsZWQ6IHRydWVcbiAgICB9KTtcblxuICAgIC8vIFJvdXRlc1xuICAgICRyb3V0ZVByb3ZpZGVyLlxuICAgICAgICB3aGVuKCcvaG9tZScsIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlld3MvcGFydGlhbHMvaG9tZS9ob21lLmh0bWwnXG4gICAgICAgIH0pLlxuICAgICAgICB3aGVuKCcvJywge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9wYXJ0aWFscy9hY2NvdW50L2xvZ2luL2xvZ2luLmh0bWwnXG4gICAgICAgIH0pLlxuICAgICAgICB3aGVuKCcvZm9yZ290Jywge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9wYXJ0aWFscy9hY2NvdW50L2ZvcmdvdC9mb3Jnb3QuaHRtbCdcbiAgICAgICAgfSkuXG4gICAgICAgIHdoZW4oJy9ldmVudHMnLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3BhcnRpYWxzL2V2ZW50cy9ldmVudHMtbGlzdC9ldmVudHMtbGlzdC5odG1sJ1xuICAgICAgICB9KS5cbiAgICAgICAgd2hlbignL2V2ZW50PzpldmVudElkJywge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9wYXJ0aWFscy9ldmVudHMvdmlldy1ldmVudC92aWV3LWV2ZW50Lmh0bWwnXG4gICAgICAgIH0pLlxuICAgICAgICB3aGVuKCcvZXZlbnQvYWRkLXN0dWRlbnRzPzpldmVudElkJywge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9wYXJ0aWFscy9ldmVudHMvYWRkLXN0dWRlbnRzL2FkZC1zdHVkZW50cy5odG1sJ1xuICAgICAgICB9KS5cbiAgICAgICAgd2hlbignL2V2ZW50L2FkZC1pbnRlcnZpZXdlcnM/OmV2ZW50SWQnLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3BhcnRpYWxzL2V2ZW50cy9hZGQtaW50ZXJ2aWV3ZXJzL2FkZC1pbnRlcnZpZXdlcnMuaHRtbCdcbiAgICAgICAgfSkuXG4gICAgICAgIHdoZW4oJy9ldmVudC9zY2hlZHVsZT86ZXZlbnRJZCcsIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlld3MvcGFydGlhbHMvZXZlbnRzL3NjaGVkdWxlL3NjaGVkdWxlLmh0bWwnXG4gICAgICAgIH0pLlxuICAgICAgICB3aGVuKCcvc3R1ZGVudHMnLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3BhcnRpYWxzL3N0dWRlbnRzL3N0dWRlbnRzLmh0bWwnXG4gICAgICAgIH0pLlxuICAgICAgICB3aGVuKCcvaW50ZXJ2aWV3ZXJzJywge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9wYXJ0aWFscy9pbnRlcnZpZXdlcnMvaW50ZXJ2aWV3ZXJzLmh0bWwnXG4gICAgICAgIH0pLlxuICAgICAgICB3aGVuKCcvYXJjaGl2ZWQtZXZlbnRzJywge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9wYXJ0aWFscy9ldmVudHMvYXJjaGl2ZWQtZXZlbnRzL2FyY2hpdmVkLWV2ZW50cy5odG1sJ1xuICAgICAgICB9KS5cbiAgICAgICAgd2hlbignL3Byb2ZpbGUnLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3BhcnRpYWxzL2FjY291bnQvcHJvZmlsZS9wcm9maWxlLmh0bWwnXG4gICAgICAgIH0pLlxuICAgICAgICB3aGVuKCcvbG9nb3V0Jywge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9wYXJ0aWFscy9hY2NvdW50L2xvZ291dC9sb2dvdXQuaHRtbCdcbiAgICAgICAgfSkuXG4gICAgICAgIHdoZW4oJy9uZXctZXZlbnQnLCB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3BhcnRpYWxzL2V2ZW50cy9uZXctZXZlbnQvbmV3LWV2ZW50Lmh0bWwnXG4gICAgICAgIH0pLlxuICAgICAgICB3aGVuKCcvcmVzZXQvOnRva2VuJywge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9wYXJ0aWFscy9hY2NvdW50L3Jlc2V0L3Jlc2V0Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ3Jlc2V0J1xuICAgICAgICB9KS5cbiAgICAgICAgb3RoZXJ3aXNlKHtcbiAgICAgICAgICAgIHJlZGlyZWN0VG86ICcvJ1xuICAgIH0pXG59XSk7XG5cbi8qXG5Ub29sYmFyIGNvbnRyb2xsZXJcbiAqL1xuYXBwLmNvbnRyb2xsZXIoJ3Rvb2xiYXInLCBbJyRyb290U2NvcGUnLCckbG9jYXRpb24nLCckc2NvcGUnLCAnJHdpbmRvdycsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRsb2NhdGlvbiwgJHNjb3BlLCAkd2luZG93KXtcbiAgICAkc2NvcGUucGF0aHMgPSB0cnVlO1xuICAgICRyb290U2NvcGUuJG9uKCdsb2dnZWQgSW4nLCBmdW5jdGlvbigpe1xuICAgICAgICBpZigkd2luZG93LnNlc3Npb25TdG9yYWdlLnRva2VuID09IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAkc2NvcGUucGF0aHMgPSB0cnVlO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICRzY29wZS5wYXRocyA9IGZhbHNlO1xuICAgICAgICAgICAgJHNjb3BlLnVzZXIgPSB7XG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6ICR3aW5kb3cuc2Vzc2lvblN0b3JhZ2UudXNlcm5hbWUucmVwbGFjZSgvXlwiKC4qKVwiJC8sICckMScpXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgJHNjb3BlLmdvSG9tZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XG4gICAgfVxufV0pO1xuXG4vKlxuRGlyZWN0aXZlIHRvIGNoZWNrIHRoZSBwYXNzd29yZHMgYXJlIHRoZSBzYW1lXG4gKi9cbmFwcC5kaXJlY3RpdmUoXCJwYXNzd29yZFZlcmlmeVwiLCBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXF1aXJlOiBcIm5nTW9kZWxcIixcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIHBhc3N3b3JkVmVyaWZ5OiAnPSdcbiAgICAgICAgfSxcbiAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBjdHJsKSB7XG4gICAgICAgICAgICBzY29wZS4kd2F0Y2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbWJpbmVkO1xuICAgICAgICAgICAgICAgIGlmIChzY29wZS5wYXNzd29yZFZlcmlmeSB8fCBjdHJsLiR2aWV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29tYmluZWQgPSBzY29wZS5wYXNzd29yZFZlcmlmeSArICdfJyArIGN0cmwuJHZpZXdWYWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbWJpbmVkO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY3RybC4kcGFyc2Vycy51bnNoaWZ0KGZ1bmN0aW9uKHZpZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9yaWdpbiA9IHNjb3BlLnBhc3N3b3JkVmVyaWZ5O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9yaWdpbiAhPT0gdmlld1ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3RybC4kc2V0VmFsaWRpdHkoXCJwYXNzd29yZFZlcmlmeVwiLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3RybC4kc2V0VmFsaWRpdHkoXCJwYXNzd29yZFZlcmlmeVwiLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmlld1ZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG59KTsiLCJcbi8qXG5TdHVkZW50IGRpYWxvZyBjb250cm9sbGVyXG4gKi9cbmFwcC5jb250cm9sbGVyKCd1cGxvYWRzJywgWyckc2NvcGUnLCAnJG1kRGlhbG9nJywgZnVuY3Rpb24oJHNjb3BlLCAkbWREaWFsb2cpe1xuICAgICRzY29wZS5vcGVuVXBsb2FkcyA9IGZ1bmN0aW9uKGV2KXtcbiAgICAgICAgJG1kRGlhbG9nLnNob3coe1xuICAgICAgICAgICAgY29udHJvbGxlcjogdXBsb2FkRmlsZSxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlld3MvcGFydGlhbHMvZGlhbG9ncy91cGxvYWQvdXBsb2FkLmh0bWwnLFxuICAgICAgICAgICAgcGFyZW50OiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSksXG4gICAgICAgICAgICB0YXJnZXRFdmVudDogZXYsXG4gICAgICAgICAgICBjbGlja091dHNpZGVUb0Nsb3NlOiB0cnVlXG4gICAgICAgIH0pXG4gICAgfTtcbiAgICBmdW5jdGlvbiB1cGxvYWRGaWxlKCRzY29wZSwgJG1kRGlhbG9nKXtcblxuICAgICAgICAkc2NvcGUuc3VibWl0ID0gZnVuY3Rpb24oZmlsZSl7XG4gICAgICAgICAgICB2YXIgbWluZSA9IHtcbiAgICAgICAgICAgICAgICBmaWxlOiBmaWxlXG4gICAgICAgICAgICB9O1xuICAgICAgICBjb25zb2xlLmxvZyhtaW5lKTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmNsb3NlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkbWREaWFsb2cuaGlkZSgpO1xuICAgICAgICB9XG4gICAgfVxufV0pOyIsIlxuLypcbkhvbWUgY29udHJvbGxlclxuICovIiwiXG4vKlxuUmVnaXN0ZXIgZGlhbG9nIGNvbnRyb2xsZXJcbiAqL1xuYXBwLmNvbnRyb2xsZXIoJ3JlZ2lzdGVyT3BlbicsIFsnJHNjb3BlJywgJyRtZERpYWxvZycsICckaHR0cCcsIGZ1bmN0aW9uKCRzY29wZSwgJG1kRGlhbG9nKXtcbiAgICAkc2NvcGUub3BlblJlZ2lzdGVyID0gZnVuY3Rpb24oZXYpe1xuICAgICAgICAkbWREaWFsb2cuc2hvdyh7XG4gICAgICAgICAgICBjb250cm9sbGVyOiByZWdpc3RlcixcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlld3MvcGFydGlhbHMvZGlhbG9ncy9yZWdpc3Rlci9yZWdpc3Rlci5odG1sJyxcbiAgICAgICAgICAgIHBhcmVudDogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpLFxuICAgICAgICAgICAgdGFyZ2V0RXZlbnQ6IGV2LFxuICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZVxuICAgICAgICB9KVxuICAgIH07XG4gICAgZnVuY3Rpb24gcmVnaXN0ZXIoJHNjb3BlLCAkaHR0cCwgJG1kRGlhbG9nKSB7XG4gICAgICAgICRzY29wZS5yZWdpc3RlciA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBlbWFpbCwgcGFzc3dvcmQpe1xuICAgICAgICAgICAgJGh0dHAucG9zdCgnL2FwaS91c2VycycsIHtcbiAgICAgICAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgZW1haWw6IGVtYWlsLFxuICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZFxuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIGlmKHJlc3BvbnNlID09IDIwMCkge1xuICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuaGlkZSgpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5jbG9zZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAkbWREaWFsb2cuaGlkZSgpO1xuICAgICAgICB9O1xuICAgIH1cbn1dKTsiLCJhcHAuY29udHJvbGxlcignaW50ZXJ2aWV3ZXJzJywgWyckc2NvcGUnLCAnJGh0dHAnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwKXtcbiAgJGh0dHAuZ2V0KCcvYXBpL2ludGVydmlld2VyJykudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAkc2NvcGUuaW50ZXJ2aWV3ZXJzID0gcmVzcG9uc2UuZGF0YVxuICB9KVxufV0pOyIsImFwcC5jb250cm9sbGVyKCdzdHVkZW50cycsIFsnJHNjb3BlJywgJyRodHRwJywgJyRtZERpYWxvZycsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRtZERpYWxvZyl7XG4gICAgJGh0dHAuZ2V0KCcvYXBpL3N0dWRlbnQnKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICRzY29wZS5zdHVkZW50cyA9IHJlc3BvbnNlLmRhdGFcbiAgICB9KTtcblxuICAgICRzY29wZS5lZGl0U3R1ZGVudCA9IGZ1bmN0aW9uKGlkKSB7XG4gICAgICAgICRodHRwLmdldCgnL2FwaS9zdHVkZW50P19pZD0nICsgaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAkc2NvcGUuc3R1ZGVudCA9IHJlc3BvbnNlLmRhdGFbMF07XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnaGVsbG8nKTtcbiAgICAgICAgICAgICRtZERpYWxvZy5zaG93KHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnZWRpdFN0dWRlbnQnLFxuICAgICAgICAgICAgICAgIGxvY2Fsczoge1xuICAgICAgICAgICAgICAgICAgICBpdGVtczogJHNjb3BlLnN0dWRlbnRcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlld3MvcGFydGlhbHMvZGlhbG9ncy9zdHVkZW50L3N0dWRlbnRFZGl0Lmh0bWwnLFxuICAgICAgICAgICAgICAgIHBhcmVudDogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpLFxuICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWVcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfTtcbn1dKTtcbmFwcC5jb250cm9sbGVyKCdlZGl0U3R1ZGVudCcsIFsnJHNjb3BlJywgJyRtZERpYWxvZycsICdpdGVtcycsIGZ1bmN0aW9uKCRzY29wZSwgJG1kRGlhbG9nLCBpdGVtcyl7XG4gICAgJHNjb3BlLnN0dWRlbnQgPSBpdGVtcztcblxuICAgICRzY29wZS5jbG9zZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4gICAgfVxufV0pOyIsIlxuLypcblN0dWRlbnQgZGlhbG9nIGNvbnRyb2xsZXJcbiAqL1xuYXBwLmNvbnRyb2xsZXIoJ3N0dWRlbnQnLCBbJyRzY29wZScsICckbWREaWFsb2cnLCBmdW5jdGlvbigkc2NvcGUsJG1kRGlhbG9nKXtcbiAgICAkc2NvcGUub3BlblN0dWRlbnRzID0gZnVuY3Rpb24oZXYpe1xuICAgICAgICAkbWREaWFsb2cuc2hvdyh7XG4gICAgICAgICAgICBjb250cm9sbGVyOiBhZGRTdHVkZW50LFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9wYXJ0aWFscy9kaWFsb2dzL3N0dWRlbnQvc3R1ZGVudC5odG1sJyxcbiAgICAgICAgICAgIHBhcmVudDogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpLFxuICAgICAgICAgICAgdGFyZ2V0RXZlbnQ6IGV2LFxuICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZVxuICAgICAgICB9KVxuICAgIH07XG4gICAgZnVuY3Rpb24gYWRkU3R1ZGVudCgkc2NvcGUpIHtcbiAgICAgICAgJHNjb3BlLmNsb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICAgICAgICAgICRzY29wZS5jb21wYW5pZXMgPSBbXG4gICAgICAgICAgICAgICAge25hbWU6ICdQcmltZSd9LFxuICAgICAgICAgICAgICAgIHtuYW1lOiAnTmVyZGVyeSd9LFxuICAgICAgICAgICAgICAgIHtuYW1lOiAnRGlnaXRhbCBQZW9wbGUnfVxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICRzY29wZS5ldmVudHMgPSBbXG4gICAgICAgICAgICAgICAge25hbWU6ICdtb2NrcyBEZWx0YSd9LFxuICAgICAgICAgICAgICAgIHtuYW1lOiAnY2FyZWVyIERlbHRhJ30sXG4gICAgICAgICAgICAgICAge25hbWU6ICdtb2NrcyBFcHNpbG9uJ31cbiAgICAgICAgICAgIF07XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbihmbmFtZSwgbG5hbWUsIGVtYWlsLCBjb2hvcnQpe1xuICAgICAgICAgICAgdmFyIHN0dWRlbnQgPSB7XG4gICAgICAgICAgICAgICAgZm5hbWU6IGZuYW1lLFxuICAgICAgICAgICAgICAgIGxuYW1lOiBsbmFtZSxcbiAgICAgICAgICAgICAgICBlbWFpbDogZW1haWwsXG4gICAgICAgICAgICAgICAgY29ob3J0OiBjb2hvcnRcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzdHVkZW50KTtcbiAgICAgICAgfVxuICAgIH1cblxufV0pOyIsImFwcC5jb250cm9sbGVyKCdhZGRTdHVkZW50cycsIFsnJHNjb3BlJywgJyRodHRwJywgJyRyb3V0ZVBhcmFtcycsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRyb3V0ZVBhcmFtcyl7XG5cbiAgICAkaHR0cC5nZXQoJy9hcGkvc3R1ZGVudCcpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgJHNjb3BlLnN0dWRlbnRzID0gcmVzcG9uc2UuZGF0YVxuICAgIH0pO1xuXG4gICAgdmFyIGV2ZW50UGFyYW0gPSAkcm91dGVQYXJhbXMuX2lkO1xuICAgICRzY29wZS5ldmVudElkID0gZXZlbnRQYXJhbTtcbiAgICBjb25zb2xlLmxvZyhldmVudFBhcmFtKTtcblxuICAgICRzY29wZS5hZGRTdHVkZW50ID0gZnVuY3Rpb24oaWQpIHtcbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICB1cmw6ICcvYXBpL2V2ZW50L2FkZFN0dWRlbnQ/X2lkPScgKyBldmVudFBhcmFtLFxuICAgICAgICAgICAgZGF0YTogZXZlbnRcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiBzdWNjZXNzKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICB9LCBmdW5jdGlvbiBlcnJvcigpIHtcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiByZWRpcmVjdCgpIHtcbiAgICAgICAgICAgIC8vIGhpZGUgcm93XG4gICAgICAgIH0pO1xuICAgIH1cbn1dKTsiLCIiLCJcbi8qXG5JbnRlcnZpZXdlciBkaWFsb2cgY29udHJvbGxlclxuICovXG5hcHAuY29udHJvbGxlcignaW50ZXJ2aWV3ZXInLCBbJyRzY29wZScsICckbWREaWFsb2cnLCBmdW5jdGlvbigkc2NvcGUsICRtZERpYWxvZyl7XG4gICAgJHNjb3BlLm9wZW5JbnRlcnZpZXdlciA9IGZ1bmN0aW9uKGV2KXtcbiAgICAgICAgJG1kRGlhbG9nLnNob3coe1xuICAgICAgICAgICAgY29udHJvbGxlcjogYWRkSW50ZXJ2aWV3ZXIsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3BhcnRpYWxzL2RpYWxvZ3MvaW50ZXJ2aWV3ZXIvaW50ZXJ2aWV3ZXIuaHRtbCcsXG4gICAgICAgICAgICBwYXJlbnQ6IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSxcbiAgICAgICAgICAgIHRhcmdldEV2ZW50OiBldixcbiAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWVcbiAgICAgICAgfSlcbiAgICB9O1xuICAgIGZ1bmN0aW9uIGFkZEludGVydmlld2VyKCRzY29wZSl7XG4gICAgICAgICRzY29wZS5jbG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICAgICAgICAgICRzY29wZS5jb2hvcnRzID0gW1xuICAgICAgICAgICAgICAgIHtuYW1lOiAnRGVsdGEnfSxcbiAgICAgICAgICAgICAgICB7bmFtZTogJ2dhbW1hJ30sXG4gICAgICAgICAgICAgICAge25hbWU6ICdFcHNpbG9uJ31cbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICAkc2NvcGUuZXZlbnRzID0gW1xuICAgICAgICAgICAgICAgIHtuYW1lOiAnbW9ja3MgRGVsdGEnfSxcbiAgICAgICAgICAgICAgICB7bmFtZTogJ2NhcmVlciBEZWx0YSd9LFxuICAgICAgICAgICAgICAgIHtuYW1lOiAnbW9ja3MgRXBzaWxvbid9XG4gICAgICAgICAgICBdO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuc3VibWl0ID0gZnVuY3Rpb24oZm5hbWUsIGxuYW1lLCB0aXRsZSwgY29tcGFueSwgbGluaywgZGVzYyl7XG4gICAgICAgICAgICB2YXIgaW50ZXJ2aWV3ZXIgPSB7XG4gICAgICAgICAgICAgICAgZk5hbWU6IGZuYW1lLFxuICAgICAgICAgICAgICAgIGxOYW1lOiBsbmFtZSxcbiAgICAgICAgICAgICAgICB0aXRsZTogdGl0bGUsXG4gICAgICAgICAgICAgICAgY29tcGFueTogY29tcGFueSxcbiAgICAgICAgICAgICAgICBsaW5rOiBsaW5rLFxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY29uc29sZS5sb2coaW50ZXJ2aWV3ZXIpO1xuICAgICAgICB9O1xuICAgIH1cbn1dKTsiLCJcbi8qXG5BcmNoaXZlZCBldmVudHMgY29udHJvbGxlclxuICovIiwiXG4vKlxuIEV2ZW50cyBsaXN0IGNvbnRyb2xsZXJcbiAgKi9cbmFwcC5jb250cm9sbGVyKCdldmVudHNDdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCAnJGZpbHRlcicsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRmaWx0ZXIpIHtcbiAgICAkaHR0cC5nZXQoJy9hcGkvZXZlbnQnKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3MocmVzcG9uc2UpIHtcblxuICAgICAgICAvLyBzZXQgZ2V0IHJlcXVlc3QgdG8gYSB2YXJpYWJsZVxuICAgICAgICBldmVudHNMaXN0ID0gcmVzcG9uc2UuZGF0YTtcblxuICAgICAgICAvLyBpbml0aWFsaXplIGFuIGVtcHR5IGFycmF5IGZvciBzdG9yaW5nIGRhdGEgdG8gYmUgdXNlZCBpbiBuZy1yZXBlYXRcbiAgICAgICAgdmFyIHRpbGVzID0gW107XG5cbiAgICAgICAgLy8gaXRlcmF0ZSBvdmVyIHJlc3BvbnNlIGRhdGEgYW5kIHB1c2ggb2JqZWN0cyBpbnRvIGFycmF5IGZvciBuZy1yZXBlYXRcbiAgICAgICAgZXZlbnRzTGlzdC5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIHBvcykge1xuICAgICAgICAgICAgdGlsZXMucHVzaCh7dGl0bGU6IHRpdGxlID0gaXRlbS5jb2hvcnQgKyAnICcgKyBpdGVtLnR5cGUsIGRhdGU6ICRmaWx0ZXIoJ2RhdGUnKShuZXcgRGF0ZShpdGVtLmRhdGUpLCAnTU0vZGQveXknKSwgX2lkOiBpdGVtLl9pZH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBzZXQgc2NvcGUgdGlsZXMgZXF1YWwgdG8gdGhlIG9iamVjdCBhcnJheVxuICAgICAgICAkc2NvcGUudGlsZXMgPSB0aWxlcztcblxuICAgIH0sIGZ1bmN0aW9uIGVycm9yKCkge30pO1xuXG59XSk7XG5cblxuYXBwLmNvbnRyb2xsZXIoJ21vZGFsQ3RybCcsIFsnJHNjb3BlJywgJyRtZERpYWxvZycsIGZ1bmN0aW9uKCRzY29wZSwgJG1kRGlhbG9nKSB7XG4gICAgJHNjb3BlLmFsZXJ0ID0gJyc7XG5cbiAgICAkc2NvcGUuc2hvd0FsZXJ0ID0gZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgIC8vIEFwcGVuZGluZyBkaWFsb2cgdG8gZG9jdW1lbnQuYm9keSB0byBjb3ZlciBzaWRlbmF2IGluIGRvY3MgYXBwXG4gICAgICAgIHZhciBjb25maXJtID0gJG1kRGlhbG9nLmNvbmZpcm0oKVxuICAgICAgICAgICAgLnRpdGxlKCdZb3UgYXJlIGFib3V0IHRvIEFyY2hpdmUgdGhpcyBFdmVudCEnKVxuICAgICAgICAgICAgLmNvbnRlbnQoJ0NsaWNrIHRvIGNvbmZpcm0uIFlvdSBjYW4gYWNjZXNzIHRoaXMgRXZlbnQgYXQgYW55IHRpbWUgaW4gQXJjaGl2ZWQgRXZlbnRzLicpXG4gICAgICAgICAgICAuYXJpYUxhYmVsKCdBcmNoaXZlJylcbiAgICAgICAgICAgIC50YXJnZXRFdmVudChldilcbiAgICAgICAgICAgIC5vaygnR290IGl0IScpXG4gICAgICAgICAgICAuY2FuY2VsKCdOZXZlcm1pbmQuJyk7XG5cbiAgICAgICAgJG1kRGlhbG9nLnNob3coY29uZmlybSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkc2NvcGUuc3RhdHVzID0gJ1lvdSBhcmNoaXZlZCB0aGlzIGV2ZW50Lic7XG4gICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRzY29wZS5zdGF0dXMgPSAnWW91IGRpZCBub3QgYXJjaGl2ZSB0aGlzIGV2ZW50Lic7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICAkc2NvcGUuc2hvd0NvbmZpcm0gPSBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgLy8gQXBwZW5kaW5nIGRpYWxvZyB0byBkb2N1bWVudC5ib2R5IHRvIGNvdmVyIHNpZGVuYXYgaW4gZG9jcyBhcHBcbiAgICAgICAgdmFyIGNvbmZpcm0gPSAkbWREaWFsb2cuY29uZmlybSgpXG4gICAgICAgICAgICAudGl0bGUoJ1dvdWxkIHlvdSBsaWtlIHRvIGRlbGV0ZSB0aGlzIEV2ZW50PycpXG4gICAgICAgICAgICAuY29udGVudCgnVGhpcyB3aWxsIHBlcm1hbmVudGx5IGRlbGV0ZSB0aGlzIEV2ZW50LicpXG4gICAgICAgICAgICAuYXJpYUxhYmVsKCdEZWxldGUnKVxuICAgICAgICAgICAgLnRhcmdldEV2ZW50KGV2KVxuICAgICAgICAgICAgLm9rKCdZZXMsIGRlbGV0ZSB0aGlzIEV2ZW50IScpXG4gICAgICAgICAgICAuY2FuY2VsKCdObyB3YXksIHRoYXQgd2FzIGNsb3NlIScpO1xuXG4gICAgICAgICRtZERpYWxvZy5zaG93KGNvbmZpcm0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJHNjb3BlLnN0YXR1cyA9ICdZb3UgZGVsZXRlZCB0aGlzIGV2ZW50Lic7XG4gICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRzY29wZS5zdGF0dXMgPSAnWW91IGRpZCBub3QgZGVsZXRlIHRoaXMgZXZlbnQuJztcbiAgICAgICAgfSk7XG4gICAgfTtcbn1dKTsiLCJcbi8qXG4gTmV3IGV2ZW50IGNvbnRyb2xsZXJcbiAgKi9cbmFwcC5jb250cm9sbGVyKCduZXdFdmVudEN0cmwnLCBbJyRzY29wZScsICckaHR0cCcsICckbG9jYXRpb24nLCAnJGZpbHRlcicsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRsb2NhdGlvbiwgJGZpbHRlcikge1xuICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICB2YXIgZXZlbnQgPSB7XG4gICAgICAgICAgICB0eXBlOiAkc2NvcGUuZXZlbnRUeXBlLFxuICAgICAgICAgICAgY29ob3J0OiAkc2NvcGUuY29ob3J0LFxuICAgICAgICAgICAgZGF0ZTogJHNjb3BlLmRhdGUsXG4gICAgICAgICAgICBsb2NhdGlvbjogJHNjb3BlLmxvY2F0aW9uLFxuICAgICAgICAgICAgc3RhcnRUaW1lOiAkZmlsdGVyKCdkYXRlJykobmV3IERhdGUoJHNjb3BlLnNUaW1lKSwgJ0hIOm1tJyksXG4gICAgICAgICAgICBlbmRUaW1lOiAkZmlsdGVyKCdkYXRlJykobmV3IERhdGUoJHNjb3BlLmVUaW1lKSwgJ0hIOm1tJyksXG4gICAgICAgICAgICBpbnRlcnZpZXdEdXJhdGlvbjogJHNjb3BlLnNsb3REdXIsXG4gICAgICAgICAgICBvcmdhbml6ZXI6ICRzY29wZS5vcmdhbml6ZXJcbiAgICAgICAgfTtcblxuICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIHVybDogJ2FwaS9ldmVudCcsXG4gICAgICAgICAgICBkYXRhOiBldmVudFxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3MoZGF0YSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yKCkge30pLnRoZW4oZnVuY3Rpb24gcmVkaXJlY3QoKSB7XG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL2V2ZW50cycpXG4gICAgICAgIH0pXG4gICAgfVxufV0pOyIsIlxuLypcbiBWaWV3IGV2ZW50cyBjb250cm9sbGVyXG4gKi9cbmFwcC5jb250cm9sbGVyKCd2aWV3RXZlbnRDdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCAnJGZpbHRlcicsICckcm91dGVQYXJhbXMnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkZmlsdGVyLCAkcm91dGVQYXJhbXMpIHtcblxuICAgIHZhciBldmVudFBhcmFtID0gJHJvdXRlUGFyYW1zLl9pZDtcbiAgICAkc2NvcGUuZXZlbnRJZCA9IGV2ZW50UGFyYW07XG5cbiAgICAkaHR0cC5nZXQoJy9hcGkvZXZlbnQ/X2lkPScgKyBldmVudFBhcmFtKS50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3MocmVzcG9uc2UpIHtcblxuICAgICAgICAkc2NvcGUuZXZlbnRUaXRsZSA9IHJlc3BvbnNlLmRhdGFbMF0uY29ob3J0ICsgJyAnICsgcmVzcG9uc2UuZGF0YVswXS50eXBlO1xuICAgICAgICAkc2NvcGUuZXZlbnREYXRlID0gJGZpbHRlcignZGF0ZScpKG5ldyBEYXRlKHJlc3BvbnNlLmRhdGFbMF0uZGF0ZSksICdNTS9kZC95eScpO1xuICAgICAgICAkc2NvcGUuZXZlbnRTdGltZSA9IHJlc3BvbnNlLmRhdGFbMF0uc3RhcnRUaW1lO1xuICAgICAgICAkc2NvcGUuZXZlbnRFdGltZSA9IHJlc3BvbnNlLmRhdGFbMF0uZW5kVGltZTtcbiAgICAgICAgJHNjb3BlLmV2ZW50RHVyID0gcmVzcG9uc2UuZGF0YVswXS5pbnRlcnZpZXdEdXJhdGlvbjtcbiAgICAgICAgJHNjb3BlLmV2ZW50TG9jID0gdHlwZW9mIHJlc3BvbnNlLmRhdGFbMF0ubG9jYXRpb24gIT0gJ3VuZGVmaW5lZCcgPyByZXNwb25zZS5kYXRhWzBdLmxvY2F0aW9uIDogJ05BJztcbiAgICAgICAgJHNjb3BlLmV2ZW50T3JnID0gdHlwZW9mIHJlc3BvbnNlLmRhdGFbMF0ub3JnYW5pemVyICE9ICd1bmRlZmluZWQnID8gcmVzcG9uc2UuZGF0YVswXS5vcmdhbml6ZXIgOiAnTkEnO1xuXG4gICAgfSwgZnVuY3Rpb24gZXJyb3IoKSB7fSk7XG5cbn1dKTsiLCJcbi8qXG5HZW5lcmF0ZSBldmVudCBjb250cm9sbGVyXG4gKi9cbmFwcC5jb250cm9sbGVyKCdnZW5lcmF0ZUN0cmwnLCBbJyRzY29wZScsICckaHR0cCcsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHApIHtcblxuICAgIC8vIHRpbWUgZXhwZXJpbWVudHNcbiAgICB2YXIgc3RhcnRUaW1lID0gbW9tZW50KCcxOjAwIFBNJywgJ2g6bW0gQScpLmZvcm1hdCgnSEg6bW0nKTtcbiAgICB2YXIgZW5kVGltZSA9IG1vbWVudCgnNDowMCBQTScsICdoOm1tIEEnKS5mb3JtYXQoJ0hIOm1tJyk7XG4gICAgdmFyIGV2ZW50TGVuZ3RoID0gbW9tZW50KGVuZFRpbWUsICdISDptbScpLmRpZmYobW9tZW50KHN0YXJ0VGltZSwgJ0hIOm1tJyksICdtaW51dGVzJyk7XG4gICAgdmFyIHNsb3RMZW5ndGggPSBtb21lbnQuZHVyYXRpb24oKGV2ZW50TGVuZ3RoIC8gOSksICdtaW51dGVzJykuYXNNaW51dGVzKCk7XG4gICAgY29uc29sZS5sb2cobW9tZW50KHN0YXJ0VGltZSwgJ0hIOm1tJykuYWRkKChzbG90TGVuZ3RoICogOCksICdtaW51dGVzJykuZm9ybWF0KCdoOm1tIEEnKSk7XG5cbiAgICAvLyBJbml0aWFsaXplIFVJIEdyaWQgdmFyaWFibGVzXG4gICAgdmFyIGdyaWRDb2xzID0gW107XG4gICAgdmFyIGdyaWREYXRhID0gW107XG5cbiAgICAvLyBVSSBHcmlkIG9wdGlvbnNcbiAgICAkc2NvcGUuZ3JpZE9wdGlvbnMgPSB7XG4gICAgICAgIGVuYWJsZVNvcnRpbmc6IGZhbHNlLFxuICAgICAgICBlbmFibGVHcmlkTWVudTogdHJ1ZSxcbiAgICAgICAgZW5hYmxlRmlsdGVyaW5nOiBmYWxzZSxcbiAgICAgICAgb25SZWdpc3RlckFwaTogZnVuY3Rpb24gKGdyaWRBcGkpIHtcbiAgICAgICAgICAgICRzY29wZS5ncmlkQXBpID0gZ3JpZEFwaTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBcIkdlbmVyYXRlXCIgYnV0dG9uIGNsaWNrIGZ1bmN0aW9uXG4gICAgJHNjb3BlLmdlbmVyYXRlID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIC8vIHJlcXVlc3QgbWF0Y2hlcyBmcm9tIHNlcnZlciBnaXZlbiBldmVudCBzZXR0aW5nc1xuICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwL3Rlc3QnXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgICAgIC8vIGVtcHR5IHRoZSBVSSBHcmlkIHZhcmlhYmxlcyBpbiBjYXNlIHRoZXJlIGlzIGRhdGFcbiAgICAgICAgICAgICRzY29wZS5ncmlkT3B0aW9ucy5jb2x1bW5EZWZzID0gW107XG4gICAgICAgICAgICAkc2NvcGUuZ3JpZE9wdGlvbnMuZGF0YSA9IFtdO1xuICAgICAgICAgICAgZ3JpZENvbHMgPSBbXTtcbiAgICAgICAgICAgIGdyaWREYXRhID0gW107XG5cbiAgICAgICAgICAgIC8vIGNvbnNvbGUgbG9nIEFQSSByZXNwb25zZSBmb3IgZGVidWdnaW5nXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG5cbiAgICAgICAgICAgIC8vIGl0ZXJhdGUgb3ZlciB0aGUgaW50ZXJ2aWV3ZXIgYXJyYXkgd2l0aGluIHRoZSByZXNwb25zZVxuICAgICAgICAgICAgLy8gY3JlYXRlIHZhcmlvdXMgYXJyYXlzIGFuZCBvYmplY3RzIHRvIG1lZXQgVUkgR3JpZCBkYXRhIHJlcXVpcmVtZW50c1xuICAgICAgICAgICAgcmVzcG9uc2UuZGF0YS5pbnRlcnZpZXdlci5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIHBvcykge1xuXG4gICAgICAgICAgICAgICAgLy8gcHVzaCB0aGUgY29tcGFueSBhbmQgaW50ZXJ2aWV3ZXIgbmFtZSBpbnRvIHRoZSBjb2x1bW4gbmFtZXMgYXJyYXlcbiAgICAgICAgICAgICAgICAvLyB0aGlzIHdpbGwgYmUgdGhlIGNvbHVtbiBoZWFkZXIgZm9yIGEgcGFydGljdWxhciBpbnRlcnZpZXdlclxuICAgICAgICAgICAgICAgIGdyaWRDb2xzLnB1c2goe25hbWU6IGl0ZW0uY29tcGFueSArICcgLyAnICsgaXRlbS5mTmFtZSwgZmllbGQ6IGl0ZW0uY29tcGFueSArICdfJyArIGl0ZW0ubmFtZSwgd2lkdGg6MTUwLCBkaXNwbGF5TmFtZTogaXRlbS5jb21wYW55ICsgJyAvICcgKyBpdGVtLmZOYW1lfSk7XG5cbiAgICAgICAgICAgICAgICAvLyBzZXQgdGhlIHNjaGVkdWxlZCBvYmplY3QgdG8gYSB2YXJpYWJsZVxuICAgICAgICAgICAgICAgIC8vIHRoaXMgb2JqZWN0IGNvbnRhaW5zIHRoZSBlbnRpcmUgc2NoZWR1bGUgZm9yIGFuIGludGVydmlld2VyXG4gICAgICAgICAgICAgICAgdmFyIHNjaGVkID0gaXRlbS5zY2hlZHVsZWQ7XG5cbiAgICAgICAgICAgICAgICAvLyBpbml0aWF0ZSBhbiBlbXB0eSBzdHVkZW50cyBhcnJheVxuICAgICAgICAgICAgICAgIC8vIHRoaXMgd2lsbCBiZSB1c2VkIHRvIHN0b3JlIHRoZSBmb3JtYXR0ZWQgc2NoZWR1bGUgZm9yIGVhY2ggY29tcGFueVxuICAgICAgICAgICAgICAgIHZhciBzdHVkZW50cyA9IFtdO1xuXG4gICAgICAgICAgICAgICAgLy8gaXRlcmF0ZSBvdmVyIHRoZSBzY2hlZHVsZWQgb2JqZWN0IHVzaW5nIHRoZSBnZXRPd25Qcm9wZXJ0eU5hbWVzIG1ldGhvZFxuICAgICAgICAgICAgICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHNjaGVkKS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtLCBpbmRleCwgYXJyYXkpIHtcblxuICAgICAgICAgICAgICAgICAgICAvLyBjcmVhdGUgYW4gYXJyYXkgb2Ygb2JqZWN0cyB0aGF0IGNvbnRhaW5zIGVhY2ggc2NoZWR1bGVkIGl0ZW1cbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyBhcnJheSB3aWxsIGNvbnRhaW4gdGhlIGZvcm1hdHRlZCBzY2hlZHVsZSBmb3IgYW4gaW50ZXJ2aWV3ZXJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGVPYmogPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGVPYmpbaXRlbS5jb21wYW55ICsgJ18nICsgaXRlbS5mbmFtZV0gPSBzY2hlZFtlbGVtXTtcbiAgICAgICAgICAgICAgICAgICAgc3R1ZGVudHMucHVzaCh0aXRsZU9iaik7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gcHVzaCB0aGUgdXBkYXRlZCBzY2hlZHVsZSBhcnJheSBpbnRvIHRoZSBtYXN0ZXIgZ3JpZERhdGEgYXJyYXlcbiAgICAgICAgICAgIGdyaWREYXRhLnB1c2goc3R1ZGVudHMpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIGdyaWREYXRhIGlzIHN0aWxsIG5vdCBjb3JyZWN0bHkgZm9ybWF0dGVkXG4gICAgICAgICAgICAvLyBlYWNoIGl0ZW0gcmVwcmVzZW50cyBhbiBpbnRlcnZpZXdlciBjb2x1bW5cbiAgICAgICAgICAgIC8vIHdoZW4gaW4gZmFjdCwgVUkgR3JpZCByZXF1aXJlcyBlYWNoIGl0ZW0gaW4gdGhlIGFycmF5IHRvIGJlIGEgcm93IG9mIGRhdGFcbiAgICAgICAgICAgIC8vIFVuZGVyc2NvcmUgdW56aXAgZnVuY3Rpb24gcGVyZm9ybXMgbmVjZXNzYXJ5IG1hdHJpeCB0cmFuc2Zvcm1hdGlvblxuICAgICAgICAgICAgZ3JpZERhdGEgPSBfLnVuemlwKGdyaWREYXRhKTtcblxuICAgICAgICAgICAgLy8gaW5pdGlhdGUgZW1wdHkgYXJyYXkgdG8gc3RvcmUgZWFjaCByb3cgYXMgYW4gb2JqZWN0IG9mIG9iamVjdHNcbiAgICAgICAgICAgIHZhciBncmlkQXJyID0gW107XG5cbiAgICAgICAgICAgIC8vIGl0ZXJhdGUgb3ZlciB1bnppcHBlZCBncmlkRGF0YVxuICAgICAgICAgICAgZ3JpZERhdGEuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgcG9zKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBpbml0aWF0ZSBlbXB0eSBvYmplY3QgZm9yIHN0b3JpbmcgaW5kaXZpZHVhbCBzY2hlZHVsZSBpdGVtc1xuICAgICAgICAgICAgICAgIHZhciByb3dPYmogPSB7fTtcblxuICAgICAgICAgICAgICAgIC8vIGl0ZXJhdGUgb3ZlciB0aGUgc2NoZWR1bGUgcm93XG4gICAgICAgICAgICAgICAgLy8gZWFjaCBpdGVtIGluIHRoZSByb3cgYXJyYXkgcmVwcmVzZW50cyBhIHNpbmdsZSBjZWxsIGluIHRoZSBncmlkXG4gICAgICAgICAgICAgICAgaXRlbS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtLCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAvLyB1c2UgVW5kZXJzY29yZSBleHRlbmQgbWV0aG9kIHRvIFwicHVzaFwiIGVhY2ggaXRlbSBpbnRvIHJvdyBvYmplY3RcbiAgICAgICAgICAgICAgICAgICAgXy5leHRlbmQocm93T2JqLCBlbGVtKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vIHB1c2ggdGhlIHJvdyBvYmplY3QgaW50byB0aGUgcHJldmlvdXNseSBpbml0aWF0ZWQgZ3JpZCBhcnJheVxuICAgICAgICAgICAgICAgIGdyaWRBcnIucHVzaChyb3dPYmopO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIGluaXRpYXRlIGFuIGVtcHR5IG9iamVjdCBmb3Igc3RvcmluZyB0aGUgZW50aXJlIHNjaGVkdWxlXG4gICAgICAgICAgICBncmlkT2JqID0ge307XG5cbiAgICAgICAgICAgIC8vIGNyZWF0ZSB0aW1lIHNsb3RzIGNvbHVtblxuICAgICAgICAgICAgdmFyIHRpbWVTbG90cyA9IFtdO1xuICAgICAgICAgICAgdmFyIHNsb3RzU2l6ZSA9IGdyaWRBcnIubGVuZ3RoO1xuICAgICAgICAgICAgd2hpbGUoc2xvdHNTaXplLS0pIHtcbiAgICAgICAgICAgICAgICB0aW1lU2xvdHMucHVzaCh7dGltZTogJ1Nsb3QgJyArICgoZ3JpZEFyci5sZW5ndGgpIC0gc2xvdHNTaXplKX0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zb2xlLmxvZyh0aW1lU2xvdHMpO1xuXG4gICAgICAgICAgICAvLyB1c2luZyBVbmRlcnNjb3JlIGV4dGVuZCBhZ2FpbiwgXCJwdXNoXCIgdGhlIGFycmF5IG9mIG9iamVjdHMgaW50byB0aGUgbWFzdGVyIG9iamVjdFxuICAgICAgICAgICAgXy5leHRlbmQoZ3JpZE9iaiwgZ3JpZEFycik7XG5cbiAgICAgICAgICAgIC8vIHVwZGF0ZSB0aGUgZ3JpZERhdGEgdmFyaWFibGVcbiAgICAgICAgICAgIGdyaWREYXRhID0gZ3JpZEFycjtcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgLy8gYWZ0ZXIgY2FwdHVyaW5nIGFuZCBmb3JtYXR0aW5nIHRoZSBkYXRhLCB1cGRhdGUgVUkgR3JpZCBvcHRpb25zXG4gICAgICAgICAgICAkc2NvcGUuZ3JpZE9wdGlvbnMuY29sdW1uRGVmcyA9IGdyaWRDb2xzO1xuICAgICAgICAgICAgJHNjb3BlLmdyaWRPcHRpb25zLmRhdGEgPSBncmlkRGF0YTtcbiAgICAgICAgfSlcbiAgICB9O1xufV0pOyIsIlxuLypcbiBGb3Jnb3QgY29udHJvbGxlclxuICAqL1xuYXBwLmNvbnRyb2xsZXIoJ3NlbmRFbWFpbCcsIFsnJHNjb3BlJywgJyRodHRwJywgJyRsb2NhdGlvbicsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRsb2NhdGlvbil7XG4gICAgJHNjb3BlLnNlbmQgPSBmdW5jdGlvbihlbWFpbCkge1xuICAgICAgICAkaHR0cC5wb3N0KCcvZm9yZ290Jywge2VtYWlsOiBlbWFpbH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09IDIwMCkge1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJylcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG59XSk7IiwiXG4vKlxuIExvZ291dCBjb250cm9sbGVyXG4gICovXG5hcHAuY29udHJvbGxlcignbG9nb3V0JywgWyckcm9vdFNjb3BlJywgJyRzY29wZScsJyRsb2NhdGlvbicsICckaW50ZXJ2YWwnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsICRsb2NhdGlvbiwgJGludGVydmFsKXtcbiAgICAkc2NvcGUubG9nb3V0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9sb2dvdXQnKTtcbiAgICAgICAgc2Vzc2lvblN0b3JhZ2UuY2xlYXIoKTtcbiAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdsb2dnZWQgSW4nKTtcbiAgICAgICAgJGludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKVxuICAgICAgICB9LCAzMDAwLCAxKVxuICAgIH07XG59XSk7IiwiXG4vKlxuIFByb2ZpbGUgY29udHJvbGxlclxuICAqL1xuYXBwLmNvbnRyb2xsZXIoJ3Byb2ZpbGUnLCBbJyRzY29wZScsICckaHR0cCcsICckd2luZG93JywgJyRsb2NhdGlvbicsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICR3aW5kb3csICRsb2NhdGlvbil7XG4gICAgJHNjb3BlLnVzZXJuYW1lID0gJHdpbmRvdy5zZXNzaW9uU3RvcmFnZS51c2VybmFtZS5yZXBsYWNlKC9eXCIoLiopXCIkLywgJyQxJyk7XG4gICAgJHNjb3BlLmVtYWlsID0gJHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5lbWFpbC5yZXBsYWNlKC9eXCIoLiopXCIkLywgJyQxJyk7XG4gICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbihwYXNzd29yZCl7XG4gICAgICAgIHZhciB1c2VybmFtZSA9ICRzY29wZS51c2VybmFtZTtcbiAgICAgICAgdmFyIGVtYWlsID0gJHNjb3BlLmVtYWlsO1xuICAgICAgICAkaHR0cC5wb3N0KCcvY2hhbmdlJywge3VzZXJuYW1lOiB1c2VybmFtZSwgZW1haWw6IGVtYWlsLCBwYXNzd29yZDogcGFzc3dvcmR9KS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICAgIGlmKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKXtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL2V2ZW50cycpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgJHNjb3BlLnN3aXRjaCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBvZmYgPSBkaXNhYmxlZDtcbiAgICAgICAgdmFyIG9uID0gZW5hYmxlZDtcblxuICAgICAgICBpZigkc2NvcGUuZW5hYmxlZCA9IG9mZil7XG4gICAgICAgICAgICAkc2NvcGUuZW5hYmxlZCA9IG9uXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkc2NvcGUuZW5hYmxlZCA9IG9mZjtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUuZW5hYmxlZClcbiAgICB9XG59XSk7IiwiXG4vKlxuIFJlc2V0IGNvbnRyb2xsZXJcbiAgKi9cbmFwcC5jb250cm9sbGVyKCdyZXNldCcsWyckc2NvcGUnLCAnJGh0dHAnLCAnJHJvdXRlUGFyYW1zJywgJyRsb2NhdGlvbicsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRyb3V0ZVBhcmFtcywgJGxvY2F0aW9uKXtcbiAgICAkc2NvcGUuY2hhbmdlUGFzcyA9IGZ1bmN0aW9uKHBhc3N3b3JkLCBjb25maXJtKXtcbiAgICAgICAgY29uc29sZS5sb2cocGFzc3dvcmQpO1xuICAgICAgICB2YXIgdG9rZW4gPSAkcm91dGVQYXJhbXMudG9rZW47XG4gICAgICAgIGlmKHBhc3N3b3JkID09PSBjb25maXJtKXtcbiAgICAgICAgICAgICRodHRwLnBvc3QoJy9yZXNldCcsIHtwYXNzd29yZDogcGFzc3dvcmQsIHRva2VuOiB0b2tlbn0pLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICBpZihyZXNwb25zZS5zdGF0dXMgPT09IDIwMCl7XG4gICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cbn1dKTsiLCJcbi8qXG4gTG9naW4gY29udHJvbGxlclxuICAqL1xuYXBwLmNvbnRyb2xsZXIoJ2xvZ2luJywgWyckcm9vdFNjb3BlJywnJHNjb3BlJywgJyRodHRwJywgJyRsb2NhdGlvbicsICckbWRUb2FzdCcsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJGh0dHAsICRsb2NhdGlvbiwgJG1kVG9hc3Qpe1xuICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpe1xuICAgICAgICAkaHR0cC5wb3N0KCcvYXV0aGVudGljYXRlJywge3VzZXJuYW1lOiB1c2VybmFtZSwgcGFzc3dvcmQ6IHBhc3N3b3JkfSkudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgICAgICAgaWYocmVzcG9uc2UuZGF0YS50b2tlbil7XG4gICAgICAgICAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnVzZXJuYW1lID0gYW5ndWxhci50b0pzb24ocmVzcG9uc2UuZGF0YS51c2VyLnVzZXJuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2UuZW1haWwgPSBhbmd1bGFyLnRvSnNvbihyZXNwb25zZS5kYXRhLnVzZXIuZW1haWwpO1xuICAgICAgICAgICAgICAgICAgICBzZXNzaW9uU3RvcmFnZS50b2tlbiA9IGFuZ3VsYXIudG9Kc29uKHJlc3BvbnNlLmRhdGEudG9rZW4pO1xuICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL2V2ZW50cycpO1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2xvZ2dlZCBJbicpXG4gICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgICRtZFRvYXN0LnNob3dTaW1wbGUocmVzcG9uc2UuZGF0YS5lcnJvcilcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICApXG4gICAgfTtcbiAgICAkc2NvcGUuZm9yZ290ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9mb3Jnb3QnKTtcbiAgICB9XG59XSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
